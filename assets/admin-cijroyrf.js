import{j as e,a as t,u as s,b as a,P as r,f as l,v as i,c as n,k as o,A as c,h as d,z as u,E as m,F as h,G as p,D as x,C as f,H as g,l as v,e as j,g as y,J as w,x as b,K as N}from"./ui-vendor-C-NzF8rS.js";import{e as S,r as _,a as C}from"./react-vendor-dEak5Vpg.js";import{B as k}from"./button-DDg2AWne.js";import{c as P,b as D,a as I,u as T,f as R,X as E,s as V,V as L,L as A}from"./index-C8K582Q_.js";import{H as M,L as O,b as F,F as H}from"./Footer-5j2EL-zX.js";import{I as U}from"./input-DK2WZrB9.js";import{L as z}from"./label-unAsljsP.js";import{T as B}from"./textarea-cjOZxLT4.js";import{m as q,u as K,r as W}from"./blogStore-DZjRwE19.js";import{u as J}from"./index-Bc7ZlNaL.js";import{U as G}from"./users-BcoWlWxz.js";import{E as Y}from"./eye-DoTbsOde.js";import{S as Q}from"./Seo-C5zCGxv8.js";import{G as $}from"./graduation-cap-DV-NuAyE.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=P("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]),Z=P("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),ee=P("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),te=P("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),se=P("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),ae=P("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),re=P("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),le=P("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),ie=P("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),ne=P("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),oe=P("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),ce=P("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),de=({children:t,adminOnly:s=!1})=>{const{user:a,loading:r,isAdmin:l}=D(),i=S();return _.useEffect(()=>{r||(a?s&&!l&&i("/"):i("/auth"))},[a,r,l,s,i]),r?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gold"})}):!a||s&&!l?null:e.jsx(e.Fragment,{children:t})};
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ue="Switch",[me,he]=t(ue),[pe,xe]=me(ue),fe=_.forwardRef((t,i)=>{const{__scopeSwitch:n,name:o,checked:c,defaultChecked:d,required:u,disabled:m,value:h="on",onCheckedChange:p,form:x,...f}=t,[g,v]=_.useState(null),j=s(i,e=>v(e)),y=_.useRef(!1),w=!g||(x||!!g.closest("form")),[b,N]=a({prop:c,defaultProp:d??!1,onChange:p,caller:ue});return e.jsxs(pe,{scope:n,checked:b,disabled:m,children:[e.jsx(r.button,{type:"button",role:"switch","aria-checked":b,"aria-required":u,"data-state":ye(b),"data-disabled":m?"":void 0,disabled:m,value:h,...f,ref:j,onClick:l(t.onClick,e=>{N(e=>!e),w&&(y.current=e.isPropagationStopped(),y.current||e.stopPropagation())})}),w&&e.jsx(je,{control:g,bubbles:!y.current,name:o,value:h,checked:b,required:u,disabled:m,form:x,style:{transform:"translateX(-100%)"}})]})});fe.displayName=ue;var ge="SwitchThumb",ve=_.forwardRef((t,s)=>{const{__scopeSwitch:a,...l}=t,i=xe(ge,a);return e.jsx(r.span,{"data-state":ye(i.checked),"data-disabled":i.disabled?"":void 0,...l,ref:s})});ve.displayName=ge;var je=_.forwardRef(({__scopeSwitch:t,control:a,checked:r,bubbles:l=!0,...n},o)=>{const c=_.useRef(null),d=s(c,o),u=J(r),m=i(a);return _.useEffect(()=>{const e=c.current;if(!e)return;const t=window.HTMLInputElement.prototype,s=Object.getOwnPropertyDescriptor(t,"checked").set;if(u!==r&&s){const t=new Event("click",{bubbles:l});s.call(e,r),e.dispatchEvent(t)}},[u,r,l]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...n,tabIndex:-1,ref:d,style:{...n.style,...m,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function ye(e){return e?"checked":"unchecked"}je.displayName="SwitchBubbleInput";var we=fe,be=ve;const Ne=_.forwardRef(({className:t,...s},a)=>e.jsx(we,{className:I("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",t),...s,ref:a,children:e.jsx(be,{className:I("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Ne.displayName=we.displayName;const Se=()=>{const[t,s]=_.useState([]),[a,r]=_.useState(!0),[l,i]=_.useState(null),[n,o]=_.useState(!1),{toast:c}=T(),d={id:"",title:"",excerpt:"",content:"",author:"",category:"Faith",image:"",video_url:"",published:!1,created_at:(new Date).toISOString(),published_date:(new Date).toISOString().split("T")[0],read_time:"5 min read"},[u,m]=_.useState(d);_.useEffect(()=>{h()},[]);const h=async()=>{try{r(!0);const e=await q();s(e)}catch(e){c({title:"Error",description:R(e),variant:"destructive"})}finally{r(!1)}};return a?e.jsx("div",{children:"Loading..."}):e.jsxs("div",{className:"space-y-6",children:[!n&&!l&&e.jsxs(k,{onClick:()=>{o(!0),i(null),m(d)},className:"btn-circular glow-emerald",children:[e.jsx(re,{className:"w-4 h-4 mr-2"}),"Create New Post"]}),(n||l)&&e.jsxs("div",{className:"glass-card p-6 space-y-4",children:[e.jsx("h3",{className:"text-2xl font-bold text-gradient-emerald",children:n?"Create New Post":"Edit Post"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Title"}),e.jsx(U,{value:u.title,onChange:e=>m({...u,title:e.target.value}),placeholder:"Post title"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Author"}),e.jsx(U,{value:u.author,onChange:e=>m({...u,author:e.target.value}),placeholder:"Author name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Category"}),e.jsx(U,{value:u.category,onChange:e=>m({...u,category:e.target.value}),placeholder:"Category"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Image URL"}),e.jsx(U,{value:u.image,onChange:e=>m({...u,image:e.target.value}),placeholder:"https://..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Video URL"}),e.jsx(U,{value:u.video_url,onChange:e=>m({...u,video_url:e.target.value}),placeholder:"https://www.youtube.com/watch?v=... or https://.../video.mp4"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Published Date"}),e.jsx(U,{type:"date",value:u.published_date||(new Date).toISOString().split("T")[0],onChange:e=>m({...u,published_date:e.target.value})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Excerpt"}),e.jsx(B,{value:u.excerpt,onChange:e=>m({...u,excerpt:e.target.value}),placeholder:"Short description",rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Content"}),e.jsx(B,{value:u.content,onChange:e=>m({...u,content:e.target.value}),placeholder:"Full post content",rows:8})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ne,{checked:u.published,onCheckedChange:e=>m({...u,published:e})}),e.jsx(z,{children:"Published"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(k,{onClick:async()=>{try{const e=u.content.trim().split(/\s+/).length,t=Math.max(1,Math.ceil(e/200));await K({id:(null==l?void 0:l.id)||void 0,title:u.title,excerpt:u.excerpt,content:u.content,author:u.author,category:u.category||"Faith",image:u.image||"",video_url:u.video_url||"",published:u.published,published_date:u.published_date||(new Date).toISOString().split("T")[0],read_time:`${t} min read`,created_at:l?l.created_at:void 0}),c({title:"Saved",description:`Post ${l?"updated":"created"} successfully.`}),o(!1),i(null),m(d),await h()}catch(e){c({title:"Error",description:R(e),variant:"destructive"})}},className:"btn-circular glow-emerald",children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),"Save"]}),e.jsxs(k,{onClick:()=>{o(!1),i(null),m(d)},variant:"outline",className:"btn-circular",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Cancel"]})]})]}),e.jsx("div",{className:"space-y-4",children:t.map(t=>e.jsxs("div",{className:"glass-card p-6 flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-semibold text-gradient-emerald",children:t.title}),e.jsx("p",{className:"text-muted-foreground mt-1",children:t.excerpt}),e.jsxs("div",{className:"flex gap-4 mt-2 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["By ",t.author]}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:t.category}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:t.published?"Published":"Draft"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(k,{size:"sm",variant:"outline",onClick:()=>(e=>{i(e),m({...e,category:e.category}),o(!1)})(t),className:"btn-circular",children:e.jsx(ne,{className:"w-4 h-4"})}),e.jsx(k,{size:"sm",variant:"outline",onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this post? This will delete it for ALL users."))try{await W(e),c({title:"Deleted",description:"Post removed successfully."}),await h()}catch(t){c({title:"Error",description:R(t),variant:"destructive"})}})(t.id),className:"btn-circular text-destructive",children:e.jsx(oe,{className:"w-4 h-4"})})]})]},t.id))})]})},_e=()=>{const{user:t}=D(),{toast:s}=T(),[a,r]=_.useState(!1),[l,i]=_.useState({full_name:"",email:""}),[n,o]=_.useState({newPassword:"",confirmPassword:""});_.useEffect(()=>{if(t)if("local-admin"===t.id)try{const e=localStorage.getItem("local_profile");if(e){const s=JSON.parse(e);i({full_name:s.full_name||"Admin",email:s.email||t.email||""})}else i({full_name:"Admin",email:t.email||""})}catch{i({full_name:"Admin",email:t.email||""})}else c()},[t]);const c=async()=>{try{const{data:e,error:s}=await V.from("profiles").select("*").eq("id",null==t?void 0:t.id).maybeSingle();if(s)throw s;if(!e&&(null==t?void 0:t.id)){const e=await V.from("profiles").insert([{id:t.id,email:t.email||"",full_name:""}]);if(e.error)throw e.error;return void i({full_name:"",email:t.email||""})}e&&i({full_name:e.full_name||"",email:e.email||""})}catch(e){s({title:"Error",description:e.message,variant:"destructive"})}};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"glass-card p-6 space-y-4",children:[e.jsx("h3",{className:"text-2xl font-bold text-gradient-emerald",children:"Profile Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Full Name"}),e.jsx(U,{value:l.full_name,onChange:e=>i({...l,full_name:e.target.value}),placeholder:"Your full name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Email"}),e.jsx(U,{value:l.email,onChange:e=>i({...l,email:e.target.value}),placeholder:"your@email.com",type:"email"})]}),e.jsxs(k,{onClick:async()=>{r(!0);try{if("local-admin"===t.id)localStorage.setItem("local_profile",JSON.stringify(l)),s({title:"Saved",description:"Profile stored locally."});else{const{error:e}=await V.from("profiles").upsert([{id:null==t?void 0:t.id,full_name:l.full_name,email:l.email}]);if(e)throw e;s({title:"Success",description:"Profile updated successfully!"})}}catch(e){s({title:"Error",description:e.message,variant:"destructive"})}finally{r(!1)}},disabled:a,className:"btn-circular glow-emerald",children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),"Update Profile"]})]})]}),e.jsxs("div",{className:"glass-card p-6 space-y-4",children:[e.jsx("h3",{className:"text-2xl font-bold text-gradient-emerald",children:"Change Password"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"New Password"}),e.jsx(U,{type:"password",value:n.newPassword,onChange:e=>o({...n,newPassword:e.target.value}),placeholder:"Enter new password",minLength:6})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Confirm Password"}),e.jsx(U,{type:"password",value:n.confirmPassword,onChange:e=>o({...n,confirmPassword:e.target.value}),placeholder:"Confirm new password",minLength:6})]}),e.jsxs(k,{onClick:async()=>{if(n.newPassword===n.confirmPassword){r(!0);try{if("local-admin"===t.id)s({title:"Not available in local mode",description:"Password change requires a real auth backend."});else{const{error:e}=await V.auth.updateUser({password:n.newPassword});if(e)throw e;s({title:"Success",description:"Password updated successfully!"}),o({newPassword:"",confirmPassword:""})}}catch(e){s({title:"Error",description:e.message,variant:"destructive"})}finally{r(!1)}}else s({title:"Error",description:"Passwords do not match",variant:"destructive"})},disabled:a||!n.newPassword||!n.confirmPassword,className:"btn-circular glow-emerald",children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),"Update Password"]})]})]})]})},Ce="greatness_verses",ke=()=>{const[t,s]=_.useState([]),[a,r]=_.useState(!0),[l,i]=_.useState(null),[n,o]=_.useState(!1),{toast:c}=T(),d={title:"",verse_text:"",translation:"",reference:"",category:"",published:!0},[u,m]=_.useState(d);_.useEffect(()=>{h()},[]);const h=async()=>{r(!0);try{const{data:e,error:t}=await V.from("greatness_verses").select("*").order("created_at",{ascending:!1});if(t)throw t;const a=(e||[]).map(e=>({id:e.id,title:e.title,verse_text:e.verse_text,translation:e.translation,reference:e.reference,category:e.category,published:e.published}));s(a)}catch(e){const t=localStorage.getItem(Ce);s(t?JSON.parse(t):[])}finally{r(!1)}},p=e=>{localStorage.setItem(Ce,JSON.stringify(e))};return a?e.jsx("div",{children:"Loading..."}):e.jsxs("div",{className:"space-y-6",children:[!n&&!l&&e.jsxs(k,{onClick:()=>{o(!0),i(null),m(d)},className:"btn-circular glow-emerald",children:[e.jsx(re,{className:"w-4 h-4 mr-2"}),"Add Verse"]}),(n||l)&&e.jsxs("div",{className:"glass-card p-6 space-y-4",children:[e.jsx("h3",{className:"text-2xl font-bold text-gradient-emerald",children:n?"Create Verse":"Edit Verse"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(z,{children:"Title"}),e.jsx(U,{value:u.title,onChange:e=>m({...u,title:e.target.value})})]}),e.jsxs("div",{children:[e.jsx(z,{children:"Reference (e.g., Quran 2:255)"}),e.jsx(U,{value:u.reference,onChange:e=>m({...u,reference:e.target.value})})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(z,{children:"Verse Text (Arabic)"}),e.jsx(B,{value:u.verse_text,onChange:e=>m({...u,verse_text:e.target.value}),rows:4,className:"font-arabic text-xl"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(z,{children:"Translation"}),e.jsx(B,{value:u.translation,onChange:e=>m({...u,translation:e.target.value}),rows:4})]}),e.jsxs("div",{children:[e.jsx(z,{children:"Category"}),e.jsx(U,{value:u.category,onChange:e=>m({...u,category:e.target.value}),placeholder:"e.g., Quran, Hadith"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"published",checked:u.published,onChange:e=>m({...u,published:e.target.checked}),className:"w-4 h-4"}),e.jsx(z,{htmlFor:"published",children:"Published"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(k,{onClick:async()=>{try{if(n){const{error:e}=await V.from("greatness_verses").insert([{title:u.title,verse_text:u.verse_text,translation:u.translation,reference:u.reference,category:u.category,published:u.published}]);if(e)throw e;c({title:"Success",description:"Verse created"})}else if(l){const{error:e}=await V.from("greatness_verses").update({title:u.title,verse_text:u.verse_text,translation:u.translation,reference:u.reference,category:u.category,published:u.published}).eq("id",l.id);if(e)throw e;c({title:"Success",description:"Verse updated"})}o(!1),i(null),m(d),await h()}catch(e){if(n){const e=[{...u,id:String(Date.now())},...t];s(e),p(e),c({title:"Saved locally",description:"Verse stored in browser"})}else if(l){const e=t.map(e=>e.id===l.id?{...e,...u}:e);s(e),p(e),c({title:"Updated locally",description:"Verse updated in browser"})}o(!1),i(null),m(d)}},className:"btn-circular glow-emerald",children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),"Save"]}),e.jsxs(k,{onClick:()=>{o(!1),i(null),m(d)},variant:"outline",className:"btn-circular",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Cancel"]})]})]}),e.jsx("div",{className:"space-y-4",children:t.map(a=>e.jsxs("div",{className:"glass-card p-6 flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-semibold text-gradient-emerald mb-2",children:a.title}),e.jsx("p",{className:"font-arabic text-2xl mb-2 text-gold",children:a.verse_text}),e.jsx("p",{className:"text-muted-foreground mb-2",children:a.translation}),e.jsx("p",{className:"text-sm text-gold",children:a.reference}),a.category&&e.jsx("span",{className:"inline-block mt-2 px-3 py-1 bg-primary/10 text-primary rounded-full text-xs",children:a.category})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(k,{size:"sm",variant:"outline",onClick:()=>(e=>{i(e),m(e),o(!1)})(a),className:"btn-circular",children:e.jsx(ne,{className:"w-4 h-4"})}),e.jsx(k,{size:"sm",variant:"outline",onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this verse?"))try{const{error:t}=await V.from("greatness_verses").delete().eq("id",e);if(t)throw t;c({title:"Deleted",description:"Verse removed"}),await h()}catch(a){const r=t.filter(t=>t.id!==e);s(r),p(r),c({title:"Deleted locally",description:"Verse removed from browser storage"})}})(a.id),className:"btn-circular text-destructive",children:e.jsx(oe,{className:"w-4 h-4"})})]})]},a.id))})]})},Pe="site_services",De=()=>{const[t,s]=_.useState([]),[a,r]=_.useState(!0),[l,i]=_.useState(null),[n,o]=_.useState(!1),{toast:c}=T(),d={title:"",description:"",category:"",icon:"",image_url:"",published:!0},[u,m]=_.useState(d);_.useEffect(()=>{h()},[]);const h=async()=>{r(!0);try{const{data:e,error:t}=await V.from("services").select("*").order("created_at",{ascending:!1});if(t)throw t;const a=(e||[]).map(e=>({id:e.id,title:e.title,description:e.description,category:e.category,icon:e.icon,image_url:e.image_url,published:e.published}));s(a)}catch(e){const t=localStorage.getItem(Pe);s(t?JSON.parse(t):[])}finally{r(!1)}},p=e=>localStorage.setItem(Pe,JSON.stringify(e));return a?e.jsx("div",{children:"Loading..."}):e.jsxs("div",{className:"space-y-6",children:[!n&&!l&&e.jsxs(k,{onClick:()=>{o(!0),i(null),m(d)},className:"btn-circular glow-emerald",children:[e.jsx(re,{className:"w-4 h-4 mr-2"})," Add Service / Video"]}),(n||l)&&e.jsxs("div",{className:"glass-card p-6 space-y-4",children:[e.jsx("h3",{className:"text-2xl font-bold text-gradient-emerald",children:n?"Create Service":"Edit Service"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(z,{children:"Title *"}),e.jsx(U,{value:u.title,onChange:e=>m({...u,title:e.target.value})})]}),e.jsxs("div",{children:[e.jsx(z,{children:"Category * (e.g., Prayer, Education, Community)"}),e.jsx(U,{value:u.category,onChange:e=>m({...u,category:e.target.value})})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(z,{children:"Description *"}),e.jsx(B,{value:u.description,onChange:e=>m({...u,description:e.target.value}),rows:4})]}),e.jsxs("div",{children:[e.jsx(z,{children:"Icon (emoji or text)"}),e.jsx(U,{value:u.icon,onChange:e=>m({...u,icon:e.target.value}),placeholder:"ðŸ“–"})]}),e.jsxs("div",{children:[e.jsx(z,{children:"Image URL"}),e.jsx(U,{value:u.image_url,onChange:e=>m({...u,image_url:e.target.value}),placeholder:"https://..."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"published-service",checked:u.published,onChange:e=>m({...u,published:e.target.checked}),className:"w-4 h-4"}),e.jsx(z,{htmlFor:"published-service",children:"Published"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(k,{onClick:async()=>{try{if(n){const{error:e}=await V.from("services").insert([{title:u.title,description:u.description,category:u.category,icon:u.icon,image_url:u.image_url,published:u.published}]);if(e)throw e;c({title:"Success",description:"Service created"})}else if(l){const{error:e}=await V.from("services").update({title:u.title,description:u.description,category:u.category,icon:u.icon,image_url:u.image_url,published:u.published}).eq("id",l.id);if(e)throw e;c({title:"Success",description:"Service updated"})}o(!1),i(null),m(d),await h()}catch(e){if(n){const e=[{...u,id:String(Date.now())},...t];s(e),p(e),c({title:"Saved locally",description:"Service stored in browser"})}else if(l){const e=t.map(e=>e.id===l.id?{...e,...u}:e);s(e),p(e),c({title:"Updated locally",description:"Service updated in browser"})}o(!1),i(null),m(d)}},className:"btn-circular glow-emerald",children:[e.jsx(le,{className:"w-4 h-4 mr-2"})," Save"]}),e.jsxs(k,{onClick:()=>{o(!1),i(null),m(d)},variant:"outline",className:"btn-circular",children:[e.jsx(E,{className:"w-4 h-4 mr-2"})," Cancel"]})]})]}),e.jsx("div",{className:"space-y-4",children:t.map(a=>e.jsxs("div",{className:"glass-card p-6 flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.icon&&e.jsx("span",{className:"text-2xl",children:a.icon}),e.jsx("h3",{className:"text-xl font-semibold text-gradient-emerald",children:a.title})]}),e.jsx("span",{className:"inline-block px-3 py-1 bg-primary/10 text-primary rounded-full text-xs mb-2",children:a.category}),e.jsx("p",{className:"text-muted-foreground mt-1",children:a.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(k,{size:"sm",variant:"outline",onClick:()=>(e=>{i(e),m(e),o(!1)})(a),className:"btn-circular",children:e.jsx(ne,{className:"w-4 h-4"})}),e.jsx(k,{size:"sm",variant:"outline",onClick:()=>(async e=>{if(confirm("Delete this service?"))try{const{error:t}=await V.from("services").delete().eq("id",e);if(t)throw t;c({title:"Deleted",description:"Service removed"}),await h()}catch(a){const r=t.filter(t=>t.id!==e);s(r),p(r),c({title:"Deleted locally",description:"Removed from browser storage"})}})(a.id),className:"btn-circular text-destructive",children:e.jsx(oe,{className:"w-4 h-4"})})]})]},a.id))})]})},Ie=()=>{const[t,s]=_.useState([]),[a,r]=_.useState(!0),{toast:l}=T(),{user:i}=D();_.useEffect(()=>{n()},[null==i?void 0:i.id]);const n=async()=>{r(!0);try{if("local-admin"===(null==i?void 0:i.id))return s([{id:"local-admin",email:(null==i?void 0:i.email)??"creepyclient530@gmail.com",full_name:"Admin",avatar_url:null,role:"admin",created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),last_login:(new Date).toISOString(),login_count:0}]),void r(!1);const{data:e,error:t}=await V.from("profiles").select("id, email, full_name, avatar_url, created_at, updated_at");if(t)throw t;if(!e||0===e.length)return s([{id:"local-admin",email:(null==i?void 0:i.email)??"creepyclient530@gmail.com",full_name:"Admin",avatar_url:null,role:"admin",created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),last_login:(new Date).toISOString(),login_count:0}]),void r(!1);const{data:a,error:l}=await V.from("user_roles").select("user_id, role"),{data:n}=await V.from("login_events").select("user_id, created_at").order("created_at",{ascending:!1}).limit(100),o=new Map,c=new Map;(n||[]).forEach(e=>{o.has(e.user_id)||o.set(e.user_id,e.created_at),c.set(e.user_id,(c.get(e.user_id)||0)+1)});const d={};(a||[]).forEach(e=>d[e.user_id]=e.role);const u=(e||[]).map(e=>({id:e.id,email:e.email,full_name:e.full_name,avatar_url:e.avatar_url,created_at:e.created_at,updated_at:e.updated_at,role:d[e.id]??"user",last_login:o.get(e.id)||null,login_count:c.get(e.id)||0}));s(u)}catch(e){s([{id:"local-admin",email:(null==i?void 0:i.email)??"creepyclient530@gmail.com",full_name:"Admin (Local Mode)",avatar_url:null,role:"admin",created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),last_login:(new Date).toISOString(),login_count:0}]),l({title:"Users (local mode)",description:"Showing local admin. Connect backend to list real users.",variant:"default"})}finally{r(!1)}},o=async(e,t,s)=>{try{if("local-admin"===(null==i?void 0:i.id))return void l({title:"Local mode",description:"Role changes are not available in local mode."});if(!t)return void l({title:"Error",description:"User email not found",variant:"destructive"});const{data:e,error:a}=await V.rpc(s?"grant_admin_role":"revoke_admin_role",{user_email:t});if(a)throw a;if(e&&!e.success)throw new Error(e.message||"Operation failed");l({title:"Success",description:s?"Admin role granted successfully":"Admin role revoked successfully"}),await n()}catch(a){l({title:"Error updating role",description:a.message??String(a),variant:"destructive"})}};return a?e.jsx("div",{className:"text-center py-8",children:"Loading users..."}):e.jsxs("div",{className:"space-y-4",children:[1===t.length&&"local-admin"===t[0].id?e.jsxs("div",{className:"glass-card p-6 bg-gradient-to-br from-emerald-500/10 to-teal-500/10 border-emerald-500/30",children:[e.jsxs("h3",{className:"font-semibold text-emerald-400 mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:"ðŸ‘¥"})," Users (Local Mode)"]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Currently showing local admin only. No users have signed up yet."}),e.jsxs("div",{className:"bg-black/20 rounded-lg p-4 space-y-2",children:[e.jsx("p",{className:"text-xs text-muted-foreground font-semibold text-gold mb-2",children:"ï¿½ To see real users logging in:"}),e.jsxs("ol",{className:"text-xs text-muted-foreground space-y-1 list-decimal list-inside",children:[e.jsxs("li",{children:["Run the SQL migration in Supabase (",e.jsx("code",{className:"bg-black/30 px-1 rounded",children:"20251104_update_existing_setup.sql"}),")"]}),e.jsx("li",{children:"Share your website URL with others"}),e.jsxs("li",{children:["They visit ",e.jsx("code",{className:"bg-black/30 px-1 rounded",children:"/auth"})," and sign up"]}),e.jsx("li",{children:"Their profiles will appear here with login history!"})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-emerald-500/20",children:e.jsxs("p",{className:"text-xs text-muted-foreground",children:["ðŸ’¡ ",e.jsx("strong",{children:"Tip:"})," You can also test by creating a second account yourself (use a different email)"]})})]}):null,t.map(t=>e.jsxs("div",{className:"glass-card p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{src:t.avatar_url||"/logo.svg",alt:t.full_name||t.email||"User",className:"w-12 h-12 rounded-full object-cover"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.full_name||t.email}),e.jsx("div",{className:"text-sm text-muted-foreground",children:t.email}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Last active: ",t.updated_at?new Date(t.updated_at).toLocaleString():"unknown"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"text-sm text-muted-foreground mr-2",children:["Role: ",e.jsx("strong",{children:t.role})]}),"local-admin"===(null==i?void 0:i.id)?e.jsx(k,{disabled:!0,className:"btn-circular",title:"Local mode",children:"Admin"}):"admin"!==t.role?e.jsx(k,{onClick:()=>o(t.id,t.email,!0),className:"btn-circular",children:"Make Admin"}):e.jsx(k,{onClick:()=>o(t.id,t.email,!1),variant:"destructive",className:"btn-circular",children:"Revoke Admin"})]}),e.jsxs("div",{className:"text-xs text-muted-foreground text-right",children:[e.jsxs("div",{children:["Last login: ",t.last_login?new Date(t.last_login).toLocaleString():"â€”"]}),e.jsxs("div",{children:["Total logins: ",t.login_count??0]})]})]},t.id))]})};function Te(e,[t,s]){return Math.min(s,Math.max(t,e))}var Re=[" ","Enter","ArrowUp","ArrowDown"],Ee=[" ","Enter"],Ve="Select",[Le,Ae,Me]=n(Ve),[Oe,Fe]=t(Ve,[Me,o]),He=o(),[Ue,ze]=Oe(Ve),[Be,qe]=Oe(Ve),Ke=t=>{const{__scopeSelect:s,children:r,open:l,defaultOpen:i,onOpenChange:n,value:o,defaultValue:c,onValueChange:d,dir:u,name:m,autoComplete:h,disabled:p,required:x,form:f}=t,v=He(s),[j,y]=_.useState(null),[w,S]=_.useState(null),[C,k]=_.useState(!1),P=b(u),[D,I]=a({prop:l,defaultProp:i??!1,onChange:n,caller:Ve}),[T,R]=a({prop:o,defaultProp:c,onChange:d,caller:Ve}),E=_.useRef(null),V=!j||(f||!!j.closest("form")),[L,A]=_.useState(new Set),M=Array.from(L).map(e=>e.props.value).join(";");return e.jsx(N,{...v,children:e.jsxs(Ue,{required:x,scope:s,trigger:j,onTriggerChange:y,valueNode:w,onValueNodeChange:S,valueNodeHasChildren:C,onValueNodeHasChildrenChange:k,contentId:g(),value:T,onValueChange:R,open:D,onOpenChange:I,dir:P,triggerPointerDownPosRef:E,disabled:p,children:[e.jsx(Le.Provider,{scope:s,children:e.jsx(Be,{scope:t.__scopeSelect,onNativeOptionAdd:_.useCallback(e=>{A(t=>new Set(t).add(e))},[]),onNativeOptionRemove:_.useCallback(e=>{A(t=>{const s=new Set(t);return s.delete(e),s})},[]),children:r})}),V?e.jsxs(Tt,{"aria-hidden":!0,required:x,tabIndex:-1,name:m,autoComplete:h,value:T,onChange:e=>R(e.target.value),disabled:p,form:f,children:[void 0===T?e.jsx("option",{value:""}):null,Array.from(L)]},M):null]})})};Ke.displayName=Ve;var We="SelectTrigger",Je=_.forwardRef((t,a)=>{const{__scopeSelect:i,disabled:n=!1,...o}=t,d=He(i),u=ze(We,i),m=u.disabled||n,h=s(a,u.onTriggerChange),p=Ae(i),x=_.useRef("touch"),[f,g,v]=Et(e=>{const t=p().filter(e=>!e.disabled),s=t.find(e=>e.value===u.value),a=Vt(t,e,s);void 0!==a&&u.onValueChange(a.value)}),j=e=>{m||(u.onOpenChange(!0),v()),e&&(u.triggerPointerDownPosRef.current={x:Math.round(e.pageX),y:Math.round(e.pageY)})};return e.jsx(c,{asChild:!0,...d,children:e.jsx(r.button,{type:"button",role:"combobox","aria-controls":u.contentId,"aria-expanded":u.open,"aria-required":u.required,"aria-autocomplete":"none",dir:u.dir,"data-state":u.open?"open":"closed",disabled:m,"data-disabled":m?"":void 0,"data-placeholder":Rt(u.value)?"":void 0,...o,ref:h,onClick:l(o.onClick,e=>{e.currentTarget.focus(),"mouse"!==x.current&&j(e)}),onPointerDown:l(o.onPointerDown,e=>{x.current=e.pointerType;const t=e.target;t.hasPointerCapture(e.pointerId)&&t.releasePointerCapture(e.pointerId),0===e.button&&!1===e.ctrlKey&&"mouse"===e.pointerType&&(j(e),e.preventDefault())}),onKeyDown:l(o.onKeyDown,e=>{const t=""!==f.current;e.ctrlKey||e.altKey||e.metaKey||1!==e.key.length||g(e.key),t&&" "===e.key||Re.includes(e.key)&&(j(),e.preventDefault())})})})});Je.displayName=We;var Ge="SelectValue",Ye=_.forwardRef((t,a)=>{const{__scopeSelect:l,className:i,style:n,children:o,placeholder:c="",...u}=t,m=ze(Ge,l),{onValueNodeHasChildrenChange:h}=m,p=void 0!==o,x=s(a,m.onValueNodeChange);return d(()=>{h(p)},[h,p]),e.jsx(r.span,{...u,ref:x,style:{pointerEvents:"none"},children:Rt(m.value)?e.jsx(e.Fragment,{children:c}):o})});Ye.displayName=Ge;var Qe=_.forwardRef((t,s)=>{const{__scopeSelect:a,children:l,...i}=t;return e.jsx(r.span,{"aria-hidden":!0,...i,ref:s,children:l||"â–¼"})});Qe.displayName="SelectIcon";var $e=t=>e.jsx(y,{asChild:!0,...t});$e.displayName="SelectPortal";var Xe="SelectContent",Ze=_.forwardRef((t,s)=>{const a=ze(Xe,t.__scopeSelect),[r,l]=_.useState();if(d(()=>{l(new DocumentFragment)},[]),!a.open){const s=r;return s?C.createPortal(e.jsx(tt,{scope:t.__scopeSelect,children:e.jsx(Le.Slot,{scope:t.__scopeSelect,children:e.jsx("div",{children:t.children})})}),s):null}return e.jsx(rt,{...t,ref:s})});Ze.displayName=Xe;var et=10,[tt,st]=Oe(Xe),at=w("SelectContent.RemoveScroll"),rt=_.forwardRef((t,a)=>{const{__scopeSelect:r,position:i="item-aligned",onCloseAutoFocus:n,onEscapeKeyDown:o,onPointerDownOutside:c,side:d,sideOffset:f,align:g,alignOffset:v,arrowPadding:j,collisionBoundary:y,collisionPadding:w,sticky:b,hideWhenDetached:N,avoidCollisions:S,...C}=t,k=ze(Xe,r),[P,D]=_.useState(null),[I,T]=_.useState(null),R=s(a,e=>D(e)),[E,V]=_.useState(null),[L,A]=_.useState(null),M=Ae(r),[O,F]=_.useState(!1),H=_.useRef(!1);_.useEffect(()=>{if(P)return u(P)},[P]),m();const U=_.useCallback(e=>{const[t,...s]=M().map(e=>e.ref.current),[a]=s.slice(-1),r=document.activeElement;for(const l of e){if(l===r)return;if(null==l||l.scrollIntoView({block:"nearest"}),l===t&&I&&(I.scrollTop=0),l===a&&I&&(I.scrollTop=I.scrollHeight),null==l||l.focus(),document.activeElement!==r)return}},[M,I]),z=_.useCallback(()=>U([E,P]),[U,E,P]);_.useEffect(()=>{O&&z()},[O,z]);const{onOpenChange:B,triggerPointerDownPosRef:q}=k;_.useEffect(()=>{if(P){let e={x:0,y:0};const t=t=>{var s,a;e={x:Math.abs(Math.round(t.pageX)-((null==(s=q.current)?void 0:s.x)??0)),y:Math.abs(Math.round(t.pageY)-((null==(a=q.current)?void 0:a.y)??0))}},s=s=>{e.x<=10&&e.y<=10?s.preventDefault():P.contains(s.target)||B(!1),document.removeEventListener("pointermove",t),q.current=null};return null!==q.current&&(document.addEventListener("pointermove",t),document.addEventListener("pointerup",s,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",t),document.removeEventListener("pointerup",s,{capture:!0})}}},[P,B,q]),_.useEffect(()=>{const e=()=>B(!1);return window.addEventListener("blur",e),window.addEventListener("resize",e),()=>{window.removeEventListener("blur",e),window.removeEventListener("resize",e)}},[B]);const[K,W]=Et(e=>{const t=M().filter(e=>!e.disabled),s=t.find(e=>e.ref.current===document.activeElement),a=Vt(t,e,s);a&&setTimeout(()=>a.ref.current.focus())}),J=_.useCallback((e,t,s)=>{const a=!H.current&&!s;(void 0!==k.value&&k.value===t||a)&&(V(e),a&&(H.current=!0))},[k.value]),G=_.useCallback(()=>null==P?void 0:P.focus(),[P]),Y=_.useCallback((e,t,s)=>{const a=!H.current&&!s;(void 0!==k.value&&k.value===t||a)&&A(e)},[k.value]),Q="popper"===i?it:lt,$=Q===it?{side:d,sideOffset:f,align:g,alignOffset:v,arrowPadding:j,collisionBoundary:y,collisionPadding:w,sticky:b,hideWhenDetached:N,avoidCollisions:S}:{};return e.jsx(tt,{scope:r,content:P,viewport:I,onViewportChange:T,itemRefCallback:J,selectedItem:E,onItemLeave:G,itemTextRefCallback:Y,focusSelectedItem:z,selectedItemText:L,position:i,isPositioned:O,searchRef:K,children:e.jsx(h,{as:at,allowPinchZoom:!0,children:e.jsx(p,{asChild:!0,trapped:k.open,onMountAutoFocus:e=>{e.preventDefault()},onUnmountAutoFocus:l(n,e=>{var t;null==(t=k.trigger)||t.focus({preventScroll:!0}),e.preventDefault()}),children:e.jsx(x,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:c,onFocusOutside:e=>e.preventDefault(),onDismiss:()=>k.onOpenChange(!1),children:e.jsx(Q,{role:"listbox",id:k.contentId,"data-state":k.open?"open":"closed",dir:k.dir,onContextMenu:e=>e.preventDefault(),...C,...$,onPlaced:()=>F(!0),ref:R,style:{display:"flex",flexDirection:"column",outline:"none",...C.style},onKeyDown:l(C.onKeyDown,e=>{const t=e.ctrlKey||e.altKey||e.metaKey;if("Tab"===e.key&&e.preventDefault(),t||1!==e.key.length||W(e.key),["ArrowUp","ArrowDown","Home","End"].includes(e.key)){let t=M().filter(e=>!e.disabled).map(e=>e.ref.current);if(["ArrowUp","End"].includes(e.key)&&(t=t.slice().reverse()),["ArrowUp","ArrowDown"].includes(e.key)){const s=e.target,a=t.indexOf(s);t=t.slice(a+1)}setTimeout(()=>U(t)),e.preventDefault()}})})})})})})});rt.displayName="SelectContentImpl";var lt=_.forwardRef((t,a)=>{const{__scopeSelect:l,onPlaced:i,...n}=t,o=ze(Xe,l),c=st(Xe,l),[u,m]=_.useState(null),[h,p]=_.useState(null),x=s(a,e=>p(e)),f=Ae(l),g=_.useRef(!1),v=_.useRef(!0),{viewport:j,selectedItem:y,selectedItemText:w,focusSelectedItem:b}=c,N=_.useCallback(()=>{if(o.trigger&&o.valueNode&&u&&h&&j&&y&&w){const e=o.trigger.getBoundingClientRect(),t=h.getBoundingClientRect(),s=o.valueNode.getBoundingClientRect(),a=w.getBoundingClientRect();if("rtl"!==o.dir){const r=a.left-t.left,l=s.left-r,i=e.left-l,n=e.width+i,o=Math.max(n,t.width),c=window.innerWidth-et,d=Te(l,[et,Math.max(et,c-o)]);u.style.minWidth=n+"px",u.style.left=d+"px"}else{const r=t.right-a.right,l=window.innerWidth-s.right-r,i=window.innerWidth-e.right-l,n=e.width+i,o=Math.max(n,t.width),c=window.innerWidth-et,d=Te(l,[et,Math.max(et,c-o)]);u.style.minWidth=n+"px",u.style.right=d+"px"}const r=f(),l=window.innerHeight-2*et,n=j.scrollHeight,c=window.getComputedStyle(h),d=parseInt(c.borderTopWidth,10),m=parseInt(c.paddingTop,10),p=parseInt(c.borderBottomWidth,10),x=d+m+n+parseInt(c.paddingBottom,10)+p,v=Math.min(5*y.offsetHeight,x),b=window.getComputedStyle(j),N=parseInt(b.paddingTop,10),S=parseInt(b.paddingBottom,10),_=e.top+e.height/2-et,C=l-_,k=y.offsetHeight/2,P=d+m+(y.offsetTop+k),D=x-P;if(P<=_){const e=r.length>0&&y===r[r.length-1].ref.current;u.style.bottom="0px";const t=h.clientHeight-j.offsetTop-j.offsetHeight,s=P+Math.max(C,k+(e?S:0)+t+p);u.style.height=s+"px"}else{const e=r.length>0&&y===r[0].ref.current;u.style.top="0px";const t=Math.max(_,d+j.offsetTop+(e?N:0)+k)+D;u.style.height=t+"px",j.scrollTop=P-_+j.offsetTop}u.style.margin=`${et}px 0`,u.style.minHeight=v+"px",u.style.maxHeight=l+"px",null==i||i(),requestAnimationFrame(()=>g.current=!0)}},[f,o.trigger,o.valueNode,u,h,j,y,w,o.dir,i]);d(()=>N(),[N]);const[S,C]=_.useState();d(()=>{h&&C(window.getComputedStyle(h).zIndex)},[h]);const k=_.useCallback(e=>{e&&!0===v.current&&(N(),null==b||b(),v.current=!1)},[N,b]);return e.jsx(nt,{scope:l,contentWrapper:u,shouldExpandOnScrollRef:g,onScrollButtonChange:k,children:e.jsx("div",{ref:m,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:S},children:e.jsx(r.div,{...n,ref:x,style:{boxSizing:"border-box",maxHeight:"100%",...n.style}})})})});lt.displayName="SelectItemAlignedPosition";var it=_.forwardRef((t,s)=>{const{__scopeSelect:a,align:r="start",collisionPadding:l=et,...i}=t,n=He(a);return e.jsx(f,{...n,...i,ref:s,align:r,collisionPadding:l,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});it.displayName="SelectPopperPosition";var[nt,ot]=Oe(Xe,{}),ct="SelectViewport",dt=_.forwardRef((t,a)=>{const{__scopeSelect:i,nonce:n,...o}=t,c=st(ct,i),d=ot(ct,i),u=s(a,c.onViewportChange),m=_.useRef(0);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),e.jsx(Le.Slot,{scope:i,children:e.jsx(r.div,{"data-radix-select-viewport":"",role:"presentation",...o,ref:u,style:{position:"relative",flex:1,overflow:"hidden auto",...o.style},onScroll:l(o.onScroll,e=>{const t=e.currentTarget,{contentWrapper:s,shouldExpandOnScrollRef:a}=d;if((null==a?void 0:a.current)&&s){const e=Math.abs(m.current-t.scrollTop);if(e>0){const a=window.innerHeight-2*et,r=parseFloat(s.style.minHeight),l=parseFloat(s.style.height),i=Math.max(r,l);if(i<a){const r=i+e,l=Math.min(a,r),n=r-l;s.style.height=l+"px","0px"===s.style.bottom&&(t.scrollTop=n>0?n:0,s.style.justifyContent="flex-end")}}}m.current=t.scrollTop})})})]})});dt.displayName=ct;var ut="SelectGroup",[mt,ht]=Oe(ut);_.forwardRef((t,s)=>{const{__scopeSelect:a,...l}=t,i=g();return e.jsx(mt,{scope:a,id:i,children:e.jsx(r.div,{role:"group","aria-labelledby":i,...l,ref:s})})}).displayName=ut;var pt="SelectLabel",xt=_.forwardRef((t,s)=>{const{__scopeSelect:a,...l}=t,i=ht(pt,a);return e.jsx(r.div,{id:i.id,...l,ref:s})});xt.displayName=pt;var ft="SelectItem",[gt,vt]=Oe(ft),jt=_.forwardRef((t,a)=>{const{__scopeSelect:i,value:n,disabled:o=!1,textValue:c,...d}=t,u=ze(ft,i),m=st(ft,i),h=u.value===n,[p,x]=_.useState(c??""),[f,v]=_.useState(!1),j=s(a,e=>{var t;return null==(t=m.itemRefCallback)?void 0:t.call(m,e,n,o)}),y=g(),w=_.useRef("touch"),b=()=>{o||(u.onValueChange(n),u.onOpenChange(!1))};if(""===n)throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return e.jsx(gt,{scope:i,value:n,disabled:o,textId:y,isSelected:h,onItemTextChange:_.useCallback(e=>{x(t=>t||((null==e?void 0:e.textContent)??"").trim())},[]),children:e.jsx(Le.ItemSlot,{scope:i,value:n,disabled:o,textValue:p,children:e.jsx(r.div,{role:"option","aria-labelledby":y,"data-highlighted":f?"":void 0,"aria-selected":h&&f,"data-state":h?"checked":"unchecked","aria-disabled":o||void 0,"data-disabled":o?"":void 0,tabIndex:o?void 0:-1,...d,ref:j,onFocus:l(d.onFocus,()=>v(!0)),onBlur:l(d.onBlur,()=>v(!1)),onClick:l(d.onClick,()=>{"mouse"!==w.current&&b()}),onPointerUp:l(d.onPointerUp,()=>{"mouse"===w.current&&b()}),onPointerDown:l(d.onPointerDown,e=>{w.current=e.pointerType}),onPointerMove:l(d.onPointerMove,e=>{var t;w.current=e.pointerType,o?null==(t=m.onItemLeave)||t.call(m):"mouse"===w.current&&e.currentTarget.focus({preventScroll:!0})}),onPointerLeave:l(d.onPointerLeave,e=>{var t;e.currentTarget===document.activeElement&&(null==(t=m.onItemLeave)||t.call(m))}),onKeyDown:l(d.onKeyDown,e=>{var t;""!==(null==(t=m.searchRef)?void 0:t.current)&&" "===e.key||(Ee.includes(e.key)&&b()," "===e.key&&e.preventDefault())})})})})});jt.displayName=ft;var yt="SelectItemText",wt=_.forwardRef((t,a)=>{const{__scopeSelect:l,className:i,style:n,...o}=t,c=ze(yt,l),u=st(yt,l),m=vt(yt,l),h=qe(yt,l),[p,x]=_.useState(null),f=s(a,e=>x(e),m.onItemTextChange,e=>{var t;return null==(t=u.itemTextRefCallback)?void 0:t.call(u,e,m.value,m.disabled)}),g=null==p?void 0:p.textContent,v=_.useMemo(()=>e.jsx("option",{value:m.value,disabled:m.disabled,children:g},m.value),[m.disabled,m.value,g]),{onNativeOptionAdd:j,onNativeOptionRemove:y}=h;return d(()=>(j(v),()=>y(v)),[j,y,v]),e.jsxs(e.Fragment,{children:[e.jsx(r.span,{id:m.textId,...o,ref:f}),m.isSelected&&c.valueNode&&!c.valueNodeHasChildren?C.createPortal(o.children,c.valueNode):null]})});wt.displayName=yt;var bt="SelectItemIndicator",Nt=_.forwardRef((t,s)=>{const{__scopeSelect:a,...l}=t;return vt(bt,a).isSelected?e.jsx(r.span,{"aria-hidden":!0,...l,ref:s}):null});Nt.displayName=bt;var St="SelectScrollUpButton",_t=_.forwardRef((t,a)=>{const r=st(St,t.__scopeSelect),l=ot(St,t.__scopeSelect),[i,n]=_.useState(!1),o=s(a,l.onScrollButtonChange);return d(()=>{if(r.viewport&&r.isPositioned){let e=function(){const e=t.scrollTop>0;n(e)};const t=r.viewport;return e(),t.addEventListener("scroll",e),()=>t.removeEventListener("scroll",e)}},[r.viewport,r.isPositioned]),i?e.jsx(Pt,{...t,ref:o,onAutoScroll:()=>{const{viewport:e,selectedItem:t}=r;e&&t&&(e.scrollTop=e.scrollTop-t.offsetHeight)}}):null});_t.displayName=St;var Ct="SelectScrollDownButton",kt=_.forwardRef((t,a)=>{const r=st(Ct,t.__scopeSelect),l=ot(Ct,t.__scopeSelect),[i,n]=_.useState(!1),o=s(a,l.onScrollButtonChange);return d(()=>{if(r.viewport&&r.isPositioned){let e=function(){const e=t.scrollHeight-t.clientHeight,s=Math.ceil(t.scrollTop)<e;n(s)};const t=r.viewport;return e(),t.addEventListener("scroll",e),()=>t.removeEventListener("scroll",e)}},[r.viewport,r.isPositioned]),i?e.jsx(Pt,{...t,ref:o,onAutoScroll:()=>{const{viewport:e,selectedItem:t}=r;e&&t&&(e.scrollTop=e.scrollTop+t.offsetHeight)}}):null});kt.displayName=Ct;var Pt=_.forwardRef((t,s)=>{const{__scopeSelect:a,onAutoScroll:i,...n}=t,o=st("SelectScrollButton",a),c=_.useRef(null),u=Ae(a),m=_.useCallback(()=>{null!==c.current&&(window.clearInterval(c.current),c.current=null)},[]);return _.useEffect(()=>()=>m(),[m]),d(()=>{var e;const t=u().find(e=>e.ref.current===document.activeElement);null==(e=null==t?void 0:t.ref.current)||e.scrollIntoView({block:"nearest"})},[u]),e.jsx(r.div,{"aria-hidden":!0,...n,ref:s,style:{flexShrink:0,...n.style},onPointerDown:l(n.onPointerDown,()=>{null===c.current&&(c.current=window.setInterval(i,50))}),onPointerMove:l(n.onPointerMove,()=>{var e;null==(e=o.onItemLeave)||e.call(o),null===c.current&&(c.current=window.setInterval(i,50))}),onPointerLeave:l(n.onPointerLeave,()=>{m()})})}),Dt=_.forwardRef((t,s)=>{const{__scopeSelect:a,...l}=t;return e.jsx(r.div,{"aria-hidden":!0,...l,ref:s})});Dt.displayName="SelectSeparator";var It="SelectArrow";_.forwardRef((t,s)=>{const{__scopeSelect:a,...r}=t,l=He(a),i=ze(It,a),n=st(It,a);return i.open&&"popper"===n.position?e.jsx(v,{...l,...r,ref:s}):null}).displayName=It;var Tt=_.forwardRef(({__scopeSelect:t,value:a,...l},i)=>{const n=_.useRef(null),o=s(i,n),c=J(a);return _.useEffect(()=>{const e=n.current;if(!e)return;const t=window.HTMLSelectElement.prototype,s=Object.getOwnPropertyDescriptor(t,"value").set;if(c!==a&&s){const t=new Event("change",{bubbles:!0});s.call(e,a),e.dispatchEvent(t)}},[c,a]),e.jsx(r.select,{...l,style:{...L,...l.style},ref:o,defaultValue:a})});function Rt(e){return""===e||void 0===e}function Et(e){const t=j(e),s=_.useRef(""),a=_.useRef(0),r=_.useCallback(e=>{const r=s.current+e;t(r),function e(t){s.current=t,window.clearTimeout(a.current),""!==t&&(a.current=window.setTimeout(()=>e(""),1e3))}(r)},[t]),l=_.useCallback(()=>{s.current="",window.clearTimeout(a.current)},[]);return _.useEffect(()=>()=>window.clearTimeout(a.current),[]),[s,r,l]}function Vt(e,t,s){const a=t.length>1&&Array.from(t).every(e=>e===t[0])?t[0]:t,r=s?e.indexOf(s):-1;let l=(i=e,n=Math.max(r,0),i.map((e,t)=>i[(n+t)%i.length]));var i,n;1===a.length&&(l=l.filter(e=>e!==s));const o=l.find(e=>e.textValue.toLowerCase().startsWith(a.toLowerCase()));return o!==s?o:void 0}Tt.displayName="SelectBubbleInput";var Lt=Je,At=Qe,Mt=$e,Ot=Ze,Ft=dt,Ht=xt,Ut=jt,zt=wt,Bt=Nt,qt=_t,Kt=kt,Wt=Dt;const Jt=Ke,Gt=Ye,Yt=_.forwardRef(({className:t,children:s,...a},r)=>e.jsxs(Lt,{ref:r,className:I("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...a,children:[s,e.jsx(At,{asChild:!0,children:e.jsx(te,{className:"h-4 w-4 opacity-50"})})]}));Yt.displayName=Lt.displayName;const Qt=_.forwardRef(({className:t,...s},a)=>e.jsx(qt,{ref:a,className:I("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(se,{className:"h-4 w-4"})}));Qt.displayName=qt.displayName;const $t=_.forwardRef(({className:t,...s},a)=>e.jsx(Kt,{ref:a,className:I("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(te,{className:"h-4 w-4"})}));$t.displayName=Kt.displayName;const Xt=_.forwardRef(({className:t,children:s,position:a="popper",...r},l)=>e.jsx(Mt,{children:e.jsxs(Ot,{ref:l,className:I("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===a&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:a,...r,children:[e.jsx(Qt,{}),e.jsx(Ft,{className:I("p-1","popper"===a&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),e.jsx($t,{})]})}));Xt.displayName=Ot.displayName;_.forwardRef(({className:t,...s},a)=>e.jsx(Ht,{ref:a,className:I("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...s})).displayName=Ht.displayName;const Zt=_.forwardRef(({className:t,children:s,...a},r)=>e.jsxs(Ut,{ref:r,className:I("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Bt,{children:e.jsx(ee,{className:"h-4 w-4"})})}),e.jsx(zt,{children:s})]}));Zt.displayName=Ut.displayName;_.forwardRef(({className:t,...s},a)=>e.jsx(Wt,{ref:a,className:I("-mx-1 my-1 h-px bg-muted",t),...s})).displayName=Wt.displayName;const es=()=>{const{toast:t}=T(),[s,a]=_.useState([]),[r,l]=_.useState(!1),[i,n]=_.useState(null),[o,c]=_.useState({title:"",description:"",content:"",image:"",video_url:"",pdf_url:"",category:"General",instructor:"",duration:"",level:"Beginner",published:!1});_.useEffect(()=>{d()},[]);const d=async()=>{try{const{data:e,error:t}=await V.from("courses").select("*").order("created_at",{ascending:!1});if(t)throw t;a(e||[])}catch(e){t({title:"Error",description:"Failed to load courses: "+e.message,variant:"destructive"})}},u=()=>{c({title:"",description:"",content:"",image:"",video_url:"",pdf_url:"",category:"General",instructor:"",duration:"",level:"Beginner",published:!1}),n(null),l(!1)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Islamic Courses Management"}),!r&&e.jsxs(k,{onClick:()=>l(!0),className:"btn-circular bg-gradient-emerald",children:[e.jsx(re,{className:"w-4 h-4 mr-2"}),"Add New Course"]})]}),r&&e.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{if(i){const{error:e}=await V.from("courses").update(o).eq("id",i);if(e)throw e;t({title:"Success",description:"Course updated successfully!"})}else{const{error:e}=await V.from("courses").insert([o]);if(e)throw e;t({title:"Success",description:"Course created successfully!"})}u(),d()}catch(s){t({title:"Error",description:"Failed to save course: "+s.message,variant:"destructive"})}},className:"glass-card p-6 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:i?"Edit Course":"Create New Course"}),e.jsx(k,{type:"button",onClick:u,variant:"ghost",size:"sm",children:e.jsx(E,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"title",children:"Course Title *"}),e.jsx(U,{id:"title",value:o.title,onChange:e=>c({...o,title:e.target.value}),placeholder:"e.g., Tajweed Fundamentals",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"instructor",children:"Instructor"}),e.jsx(U,{id:"instructor",value:o.instructor,onChange:e=>c({...o,instructor:e.target.value}),placeholder:"e.g., Sheikh Ahmed"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"category",children:"Category"}),e.jsx(U,{id:"category",value:o.category,onChange:e=>c({...o,category:e.target.value}),placeholder:"e.g., Quran Studies"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"level",children:"Level"}),e.jsxs(Jt,{value:o.level,onValueChange:e=>c({...o,level:e}),children:[e.jsx(Yt,{children:e.jsx(Gt,{})}),e.jsxs(Xt,{children:[e.jsx(Zt,{value:"Beginner",children:"Beginner"}),e.jsx(Zt,{value:"Intermediate",children:"Intermediate"}),e.jsx(Zt,{value:"Advanced",children:"Advanced"}),e.jsx(Zt,{value:"All Levels",children:"All Levels"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"duration",children:"Duration"}),e.jsx(U,{id:"duration",value:o.duration,onChange:e=>c({...o,duration:e.target.value}),placeholder:"e.g., 8 weeks, 20 hours"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"image",children:"Image URL"}),e.jsx(U,{id:"image",value:o.image,onChange:e=>c({...o,image:e.target.value}),placeholder:"https://example.com/image.jpg"})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(z,{htmlFor:"video_url",children:"Video URL (YouTube, Vimeo, etc.)"}),e.jsx(U,{id:"video_url",value:o.video_url,onChange:e=>c({...o,video_url:e.target.value}),placeholder:"https://youtube.com/watch?v=..."})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(z,{htmlFor:"pdf_url",children:"PDF URL (Course Materials)"}),e.jsx(U,{id:"pdf_url",value:o.pdf_url,onChange:e=>c({...o,pdf_url:e.target.value}),placeholder:"https://example.com/course-materials.pdf"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Upload your PDF to a hosting service (Google Drive, Dropbox, etc.) and paste the direct link here"})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(z,{htmlFor:"description",children:"Short Description *"}),e.jsx(B,{id:"description",value:o.description,onChange:e=>c({...o,description:e.target.value}),placeholder:"Brief overview of the course...",rows:3,required:!0})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(z,{htmlFor:"content",children:"Full Content"}),e.jsx(B,{id:"content",value:o.content,onChange:e=>c({...o,content:e.target.value}),placeholder:"Detailed course content, syllabus, what students will learn...",rows:6})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ne,{id:"published",checked:o.published,onCheckedChange:e=>c({...o,published:e})}),e.jsx(z,{htmlFor:"published",children:"Published"})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsxs(k,{type:"submit",className:"btn-circular bg-gradient-emerald",children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),i?"Update Course":"Create Course"]}),e.jsx(k,{type:"button",onClick:u,variant:"outline",children:"Cancel"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-xl font-semibold",children:["All Courses (",s.length,")"]}),0===s.length?e.jsx("div",{className:"glass-card p-8 text-center text-muted-foreground",children:"No courses found. Create your first course!"}):e.jsx("div",{className:"grid gap-4",children:s.map(s=>e.jsx("div",{className:"glass-card p-6",children:e.jsxs("div",{className:"flex justify-between items-start gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h4",{className:"text-xl font-bold text-gradient-emerald",children:s.title}),s.published?e.jsx("span",{className:"px-2 py-1 bg-emerald-500/20 text-emerald-500 text-xs rounded-full",children:"Published"}):e.jsx("span",{className:"px-2 py-1 bg-gray-500/20 text-gray-500 text-xs rounded-full",children:"Draft"})]}),e.jsx("p",{className:"text-muted-foreground mb-3",children:s.description}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[s.instructor&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("strong",{children:"Instructor:"})," ",s.instructor]}),s.level&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("strong",{children:"Level:"})," ",s.level]}),s.duration&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("strong",{children:"Duration:"})," ",s.duration]}),s.category&&e.jsx("span",{className:"px-2 py-1 bg-gold/10 text-gold rounded-full text-xs",children:s.category})]}),e.jsxs("div",{className:"mt-2 flex gap-3",children:[s.video_url&&e.jsx("div",{className:"text-sm text-blue-500",children:"ðŸ“¹ Video attached"}),s.pdf_url&&e.jsx("div",{className:"text-sm text-emerald-500",children:"ðŸ“„ PDF attached"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(k,{onClick:()=>(e=>{c(e),n(e.id||null),l(!0)})(s),variant:"outline",size:"sm",className:"btn-circular",children:e.jsx(ae,{className:"w-4 h-4"})}),e.jsx(k,{onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this course?"))try{const{error:s}=await V.from("courses").delete().eq("id",e);if(s)throw s;t({title:"Success",description:"Course deleted successfully!"}),d()}catch(s){t({title:"Error",description:"Failed to delete course: "+s.message,variant:"destructive"})}})(s.id),variant:"outline",size:"sm",className:"btn-circular text-red-500 hover:text-red-600",children:e.jsx(oe,{className:"w-4 h-4"})})]})]})},s.id))})]})]})},ts=_.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:I("rounded-lg border bg-card text-card-foreground shadow-sm",t),...s}));ts.displayName="Card";const ss=_.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:I("flex flex-col space-y-1.5 p-6",t),...s}));ss.displayName="CardHeader";const as=_.forwardRef(({className:t,...s},a)=>e.jsx("h3",{ref:a,className:I("text-2xl font-semibold leading-none tracking-tight",t),...s}));as.displayName="CardTitle";const rs=_.forwardRef(({className:t,...s},a)=>e.jsx("p",{ref:a,className:I("text-sm text-muted-foreground",t),...s}));rs.displayName="CardDescription";const ls=_.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:I("p-6 pt-0",t),...s}));ls.displayName="CardContent";_.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:I("flex items-center p-6 pt-0",t),...s})).displayName="CardFooter";const is=()=>{const[t,s]=_.useState(null),[a,r]=_.useState(!0);T();const l=async()=>{try{r(!0);try{await V.rpc("cleanup_old_sessions")}catch(e){}const{count:t,error:a}=await V.from("visitors").select("*",{count:"exact",head:!0}),{count:l,error:i}=await V.from("page_views").select("*",{count:"exact",head:!0}),{count:n,error:o}=await V.from("active_sessions").select("*",{count:"exact",head:!0}).gte("last_activity",new Date(Date.now()-18e5).toISOString()),c=new Date;c.setHours(0,0,0,0);const{data:d,error:u}=await V.from("page_views").select("visitor_id").gte("created_at",c.toISOString()),m=new Set((null==d?void 0:d.map(e=>e.visitor_id))||[]).size,{count:h,error:p}=await V.from("page_views").select("*",{count:"exact",head:!0}).gte("created_at",c.toISOString()),{data:x,error:f}=await V.from("page_views").select("page_path").gte("created_at",c.toISOString()),g={};null==x||x.forEach(e=>{g[e.page_path]=(g[e.page_path]||0)+1});const v=Object.entries(g).map(([e,t])=>({page_path:e,count:t})).sort((e,t)=>t.count-e.count).slice(0,5),j=new Date;j.setDate(j.getDate()-7),j.setHours(0,0,0,0);const{data:y,error:w}=await V.from("page_views").select("created_at").gte("created_at",j.toISOString()),b={};null==y||y.forEach(e=>{const t=new Date(e.created_at).toLocaleDateString();b[t]=(b[t]||0)+1});const N=Object.entries(b).map(([e,t])=>({date:e,count:t})).sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime());s({totalVisitors:t||0,totalPageViews:l||0,activeUsers:n||0,todayVisitors:m||0,todayPageViews:h||0,popularPages:v,visitorsTrend:N})}catch(t){s({totalVisitors:0,totalPageViews:0,activeUsers:0,todayVisitors:0,todayPageViews:0,popularPages:[],visitorsTrend:[]})}finally{r(!1)}};return _.useEffect(()=>{l();const e=setInterval(l,3e4);return()=>clearInterval(e)},[]),a?e.jsx(A,{}):t?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold mb-2",children:"Analytics Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Track visitor statistics and site performance"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(ts,{children:[e.jsxs(ss,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(as,{className:"text-sm font-medium",children:"Active Users"}),e.jsx(X,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ls,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.activeUsers}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Currently online"})]})]}),e.jsxs(ts,{children:[e.jsxs(ss,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(as,{className:"text-sm font-medium",children:"Today's Visitors"}),e.jsx(G,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ls,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.todayVisitors}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Unique visitors today"})]})]}),e.jsxs(ts,{children:[e.jsxs(ss,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(as,{className:"text-sm font-medium",children:"Today's Page Views"}),e.jsx(Y,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ls,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.todayPageViews}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Pages viewed today"})]})]}),e.jsxs(ts,{children:[e.jsxs(ss,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(as,{className:"text-sm font-medium",children:"Total Visitors"}),e.jsx(ce,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ls,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.totalVisitors}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All time"})]})]})]}),e.jsxs(ts,{children:[e.jsxs(ss,{children:[e.jsx(as,{children:"Popular Pages Today"}),e.jsx(rs,{children:"Most visited pages in the last 24 hours"})]}),e.jsx(ls,{children:t.popularPages.length>0?e.jsx("div",{className:"space-y-4",children:t.popularPages.map((t,s)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"font-medium",children:[s+1,"."]}),e.jsx("div",{className:"text-sm",children:t.page_path||"/"})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[t.count," views"]})]},s))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No page views today"})})]}),e.jsxs(ts,{children:[e.jsxs(ss,{children:[e.jsx(as,{children:"Visitors Trend (Last 7 Days)"}),e.jsx(rs,{children:"Daily page views over the past week"})]}),e.jsx(ls,{children:t.visitorsTrend.length>0?e.jsx("div",{className:"space-y-2",children:t.visitorsTrend.map((t,s)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm font-medium",children:t.date}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[t.count," views"]}),e.jsx("div",{className:"h-2 bg-primary rounded-full",style:{width:`${Math.min(5*t.count,100)}px`}})]})]},s))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No data available for the past 7 days"})})]}),e.jsxs(ts,{children:[e.jsxs(ss,{children:[e.jsx(as,{children:"Overall Statistics"}),e.jsx(rs,{children:"All-time metrics"})]}),e.jsx(ls,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"Total Visitors"}),e.jsx("div",{className:"text-2xl font-bold",children:t.totalVisitors})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"Total Page Views"}),e.jsx("div",{className:"text-2xl font-bold",children:t.totalPageViews})]})]})})]})]}):e.jsx("div",{className:"text-center py-8",children:"No analytics data available"})},ns=()=>{const{signOut:t}=D(),s=S(),[a,r]=_.useState("analytics");return e.jsx(de,{adminOnly:!0,children:e.jsxs("div",{className:"min-h-screen",children:[e.jsx(Q,{title:"Admin â€“ Kirtase Hidayah",description:"Admin dashboard for managing content and settings."}),e.jsx(M,{}),e.jsxs("div",{className:"container mx-auto px-4 py-24",children:[e.jsxs("div",{className:"mb-8 flex justify-between items-center",children:[e.jsx("h1",{className:"text-4xl font-bold text-gradient-emerald",children:"Admin Dashboard"}),e.jsxs(k,{onClick:async()=>{await t(),s("/")},variant:"outline",className:"btn-circular",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Sign Out"]})]}),e.jsxs("div",{className:"glass-card p-6 mb-8",children:[e.jsxs("div",{className:"flex gap-4 border-b border-border pb-4 overflow-x-auto",children:[e.jsxs("button",{onClick:()=>r("analytics"),className:"flex items-center gap-2 px-4 py-2 rounded-lg transition-all whitespace-nowrap "+("analytics"===a?"bg-gradient-emerald text-white":"hover:bg-accent"),children:[e.jsx(Z,{className:"w-4 h-4"}),"Analytics"]}),e.jsxs("button",{onClick:()=>r("blogs"),className:"flex items-center gap-2 px-4 py-2 rounded-lg transition-all whitespace-nowrap "+("blogs"===a?"bg-gradient-emerald text-white":"hover:bg-accent"),children:[e.jsx(F,{className:"w-4 h-4"}),"Blog Management"]}),e.jsxs("button",{onClick:()=>r("verses"),className:"flex items-center gap-2 px-4 py-2 rounded-lg transition-all whitespace-nowrap "+("verses"===a?"bg-gradient-emerald text-white":"hover:bg-accent"),children:[e.jsx(F,{className:"w-4 h-4"}),"Verses"]}),e.jsxs("button",{onClick:()=>r("services"),className:"flex items-center gap-2 px-4 py-2 rounded-lg transition-all whitespace-nowrap "+("services"===a?"bg-gradient-emerald text-white":"hover:bg-accent"),children:[e.jsx(F,{className:"w-4 h-4"}),"Services & Videos"]}),e.jsxs("button",{onClick:()=>r("courses"),className:"flex items-center gap-2 px-4 py-2 rounded-lg transition-all whitespace-nowrap "+("courses"===a?"bg-gradient-emerald text-white":"hover:bg-accent"),children:[e.jsx($,{className:"w-4 h-4"}),"Islamic Courses"]}),e.jsxs("button",{onClick:()=>r("users"),className:"flex items-center gap-2 px-4 py-2 rounded-lg transition-all whitespace-nowrap "+("users"===a?"bg-gradient-emerald text-white":"hover:bg-accent"),children:[e.jsx(G,{className:"w-4 h-4"}),"Users"]}),e.jsxs("button",{onClick:()=>r("profile"),className:"flex items-center gap-2 px-4 py-2 rounded-lg transition-all whitespace-nowrap "+("profile"===a?"bg-gradient-emerald text-white":"hover:bg-accent"),children:[e.jsx(ie,{className:"w-4 h-4"}),"Profile Settings"]})]}),e.jsxs("div",{className:"mt-6",children:["analytics"===a&&e.jsx(is,{}),"blogs"===a&&e.jsx(Se,{}),"profile"===a&&e.jsx(_e,{}),"verses"===a&&e.jsx(ke,{}),"services"===a&&e.jsx(De,{}),"courses"===a&&e.jsx(es,{}),"users"===a&&e.jsx(Ie,{})]})]})]}),e.jsx(H,{})]})})};export{ns as default};
